object GroupByDeal {
  
  val data: String = s"""20140918	5210	topright	3907	2250
20140918	5210	topright	8566	3593
20140918	5210	bottomleft	7336	4195
20140918	5210	bottomleft	15145	6405
20140919	5210	topright	3357	1950
20140919	5210	topright	7660	3126
20140921	5210	topright	3366	1877
20140920	5210	topright	3484	1922
20140921	5210	topright	7436	2990
20140919	5210	bottomleft	6761	3994
20140920	5210	topright	7639	3115
20140919	5210	bottomleft	14188	5976
20140921	5210	bottomleft	6508	3903
20140920	5210	bottomleft	6646	4009
20140921	5210	bottomleft	13989	5924
20140920	5210	bottomleft	14826	6104
20140924	5210	topright	3854	1559
20140922	5210	topright	2627	1509
20140922	5210	topright	6060	2461
20140924	5210	bottomleft	3573	1857
20140924	5210	bottomleft	8582	3194
20140924	5210	topright	2036	1125
20140922	5210	bottomleft	5507	3297
20140924	5210	topright	3591	1787
20140922	5210	bottomleft	11681	4972
20140923	5210	topright	2160	1104
20140924	5210	bottomleft	5013	2936
20140923	5210	bottomleft	10621	5317
20140923	5210	topright	5415	2021
20140923	5210	bottomleft	4442	2422
20140923	5210	bottomleft	10773	4128
20140923	5210	topright	2559	1462
20140923	5210	topright	5540	2663
20140923	5210	bottomleft	5625	3168
20140924	5210	topright	1305	758
20140924	5210	bottomleft	7995	3976
20140925	5210	bottomleft	3	1
20140925	5210	topright	1	1
20140925	5210	topright	2	1
20140925	5210	bottomleft	2	1
20140925	5210	bottomleft	19	1
20140926	5210	topright	1	1
20140926	5210	bottomleft	3654	1989
20140927	5210	bottomleft	9510	3586
20140927	5210	topright	2388	1139
20140925	5210	bottomleft	3647	2133
20140926	5210	topright	2	2
20140926	5210	bottomleft	8980	3399
20140926	5210	topright	2932	1329
20140927	5210	topright	17	9
20140927	5210	bottomleft	9279	5435
20140925	5210	bottomleft	1	1
20140925	5210	bottomleft	9600	3689
20140925	5210	topright	3501	1788
20140926	5210	topright	2	2
20140926	5210	topright	16	7
20140926	5210	bottomleft	7374	4263
20140925	5210	bottomleft	1	1
20140925	5210	topright	3	1
20140925	5210	topright	120	38
20140926	5210	topright	5	2
20140926	5210	topright	1	1
20140927	5210	bottomleft	5188	2503
20140925	5210	topright	2	1
20140925	5210	topright	1	1
20140925	5210	topright	1	1
20140926	5210	topright	1	1
20140926	5210	topright	1	1
20140926	5210	topright	8	2
20140926	5210	bottomleft	6218	3136
20140927	5210	topright	1861	963
20140927	5210	bottomleft	45	14
20140925	5210	bottomleft	2	1
20140925	5210	topright	1	1
20140925	5210	topright	11	1
20140925	5210	bottomleft	7698	4145
20140926	5210	topright	2	2
20140926	5210	topright	1675	902
20140926	5210	bottomleft	67	20
20140927	5210	topright	4668	1833
20140925	5210	topright	1	1
20140925	5210	topright	1703	911
20140925	5210	bottomleft	191	66
20140926	5210	topright	1	1
20140926	5210	topright	4263	1699
20140927	5210	topright	4356	2412
20140925	5210	bottomleft	8	1
20140925	5210	topright	4	1
20140925	5210	bottomleft	2	1
20140925	5210	topright	4502	1746
20140926	5210	topright	1	1
20140926	5210	topright	3301	1831
20140927	5210	bottomleft	3950	2020
20140928	5210	bottomleft	7302	4221
20140930	5210	bottomleft	9074	3540
20140930	5210	topright	22	7
20140929	5210	bottomleft	1192	550
20140929	5210	topright	1	1
20140930	5210	topright	7	2
20140930	5210	bottomleft	7702	4530
20140928	5210	bottomleft	4248	2129
20140929	5210	topright	1542	802
20140929	5210	bottomleft	3	2
20140928	5210	topright	1482	770
20140928	5210	bottomleft	29	5
20140929	5210	topright	4130	1635
20140930	5210	bottomleft	52	20
20140930	5210	topright	4036	2045
20140928	5210	topright	3888	1617
20140929	5210	topright	3670	2049
20140930	5210	topright	1596	878
20140930	5210	bottomleft	16	5
20140928	5210	topright	2993	1707
20140929	5210	bottomleft	3237	1902
20140930	5210	topright	4428	1752
20140928	5210	bottomleft	3448	1825
20140929	5210	bottomleft	8950	3402
20140929	5210	topright	361	185
20140930	5210	topright	3649	1996
20140930	5210	bottomleft	8540	4586
20140928	5210	bottomleft	8614	3297
20140928	5210	topright	1932	937
20140929	5210	topright	9	4
20140929	5210	bottomleft	8107	4698
20140930	5210	bottomleft	3470	2008
20141002	5210	bottomleft	52	17
20141002	5210	topright	3850	2045
20141003	5210	topright	14	8
20141001	5210	bottomleft	28	11
20141001	5210	topright	4985	2633
20141002	5210	topright	41	12
20141002	5210	bottomleft	25	5
20141003	5210	topright	4418	1841
20141001	5210	topright	106	29
20141001	5210	bottomleft	6	1
20141002	5210	topright	4996	2015
20141003	5210	topright	3317	1863
20141003	5210	bottomleft	7272	4022
20141001	5210	topright	5503	2079
20141002	5210	topright	3638	2181
20141002	5210	bottomleft	9020	5001
20141003	5210	bottomleft	22	6
20141001	5210	topright	4178	2310
20141001	5210	bottomleft	11251	6296
20141002	5210	bottomleft	62	19
20141003	5210	bottomleft	9923	3855
20141003	5210	topright	9	5
20141001	5210	bottomleft	78	33
20141002	5210	bottomleft	10659	4238
20141002	5210	topright	28	5
20141003	5210	topright	1	1
20141003	5210	bottomleft	7525	4479
20141001	5210	bottomleft	10843	4336
20141001	5210	topright	22	8
20141002	5210	topright	2	1
20141002	5210	bottomleft	8447	4920
20141001	5210	bottomleft	8725	5135
20141003	5210	bottomleft	32	3
20141003	5210	topright	2958	1637
20141004	5210	topright	4448	1831
20141005	5210	topright	3088	1802
20141005	5210	bottomleft	6260	3514
20141006	5210	bottomleft	15	6
20141007	5210	bottomleft	10120	4355
20141007	5210	topright	2	1
20141004	5210	topright	3306	1876
20141004	5210	bottomleft	6721	3765
20141005	5210	bottomleft	20	8
20141006	5210	bottomleft	9253	3793
20141006	5210	topright	11	4
20141007	5210	bottomleft	8008	4892
20141004	5210	bottomleft	34	8
20141005	5210	bottomleft	9326	3773
20141005	5210	topright	27	4
20141006	5210	bottomleft	6861	4067
20141004	5210	bottomleft	9350	3835
20141004	5210	topright	19	5
20141005	5210	bottomleft	6718	4159
20141007	5210	bottomleft	13	5
20141007	5210	topright	1463	806
20141004	5210	topright	4	1
20141004	5210	bottomleft	7421	4269
20141006	5210	bottomleft	4	2
20141006	5210	topright	2710	1470
20141007	5210	topright	16	4
20141007	5210	bottomleft	4	1
20141005	5210	bottomleft	16	6
20141005	5210	topright	2828	1519
20141006	5210	topright	4	2
20141006	5210	bottomleft	2	1
20141007	5210	topright	4518	1960
20141004	5210	bottomleft	22	6
20141004	5210	topright	2973	1599
20141005	5210	topright	5	3
20141005	5210	bottomleft	2	1
20141006	5210	topright	4319	1776
20141007	5210	topright	3543	2091
20141007	5210	bottomleft	3226	1860
20141004	5210	topright	6	3
20141004	5210	bottomleft	2	1
20141005	5210	topright	4396	1770
20141006	5210	topright	3158	1792
20141006	5210	bottomleft	5942	3388
20141007	5210	bottomleft	13	3
"""
  def main(arg: Array[String]) = {
    var maps = scala.collection.mutable.Map.empty[String, Int]
    val lines = data.split("\\r\\n")
    for (line <- lines){
      val words = line.split("	")
      var oldcounts = 0
      if (maps.contains(words(0)+words(1)+words(2)))
        oldcounts = maps(words(0)+words(1)+words(2)) + words(3).toInt
      else 
        oldcounts = 0
        
      maps += ((words(0)+words(1)+words(2)) -> oldcounts)
    }
    
    maps.foreach(f => println(f._1 + "  " +  f._2))

  }

}